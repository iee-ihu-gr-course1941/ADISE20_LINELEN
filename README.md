# ADISE20_LINELEN

Table of Contents
=================
   * [Εγκατάσταση](#εγκατάσταση)
      * [Απαιτήσεις](#απαιτήσεις)
      * [Οδηγίες Εγκατάστασης](#οδηγίες-εγκατάστασης)
   * [Περιγραφή API](#περιγραφή-api)
      * [Methods](#methods)
         * [Board](#board)
            * [Ανάγνωση Board](#ανάγνωση-board)
            * [Αρχικοποίηση Board](#αρχικοποίηση-board)
         * [Card](#card)
            * [Ανάγνωση Θέσης/Κάρτας](#ανάγνωση-θέσης-κάρτας)
            * [Μεταβολή Θέσης Κάρτας](#μεταβολή-θέσης-κάρτας)
         * [Player](#player)
            * [Ανάγνωση στοιχείων παίκτη](#ανάγνωση-στοιχείων-παίκτη)
            * [Καθορισμός στοιχείων παίκτη](#καθορισμός-στοιχείων-παίκτη)
         * [Status](#status)
            * [Ανάγνωση κατάστασης παιχνιδιού](#ανάγνωση-κατάστασης-παιχνιδιού)
      * [Entities](#entities)
         * [Board](#board-1)
         * [Players](#players)
         * [Game_status](#game_status)

# Demo Page

Μπορείτε να κατεβάσετε τοπικά ή να επισκεφτείτε την σελίδα: 
--------------------------------------------------------------

# Εγκατάσταση

## Απαιτήσεις

* Apache2
* Mysql Server
* php

## Οδηγίες Εγκατάστασης

 * Κάντε clone το project σε κάποιον φάκελο <br/>
  -------------------------------------------------------

 * Βεβαιωθείτε ότι ο φάκελος είναι προσβάσιμος από τον Apache Server. Πιθανόν να χρειαστεί να καθορίσετε τις παρακάτω ρυθμίσεις.

 * Θα πρέπει να δημιουργήσετε στην Mysql την βάση με όνομα 'project_db' και να φορτώσετε σε αυτήν την βάση τα δεδομένα από το αρχείο db/schema.sql

 * Θα πρέπει να φτιάξετε το αρχείο lib/config_local.php το οποίο να περιέχει:
```
    <?php
	$DB_PASS = 'κωδικός';
	$DB_USER = 'όνομα χρήστη';
    ?>
```

# Περιγραφή Παιχνιδιού

Η Αβησσυνία είναι ένα χαρτοπαίγνιο που παίζουν συνήθως τέσσερεις παίκτες, ο καθένας για λογαριασμό του. Σε αυτήν την εκδοχή το παιχνίδι απαιτεί ιδιαίτερες ικανότητες από τον παίκτη. Δεν αποκλείεται όμως οι παίκτες να σχηματίζουν δύο ομάδες (από δύο παίκτες η καθεμία) ή να παιχθεί από δύο μόνο παίκτες. Σε αυτές τις περιπτώσεις όμως ο παράγοντας τύχη αυξάνεται εις βάρος της ικανότητας του παίκτη. Σκοπός του παιχνιδιού είναι να μαζέψει ο παίκτης όσα περισσότερα φύλλα μπορεί. Ο αριθμός των φύλλων που θα μαζέψει ισοδυναμεί με τους πόντους που θα κερδίσει στη συγκεκριμένη παρτίδα. Εξαίρεση αποτελούν οι βαλέδες που ισοδυναμούν με τρεις πόντους ο καθένας.

**Οδηγίες:**

 Πώς παίζεται;;
 
Χρησιμοποιείται μία τράπουλα των 52 φύλλων και αρχικά μοιράζεται κάθε παίκτης από έξι φύλλα,
ενώ αφήνονται στη μέση του τραπεζιού τέσσερα, το ένα επάνω στο άλλο,
Κάθε παίκτης παίζει με την σειρά, με φορά από δεξιά προς τα αριστερά, από ένα φύλλο που κρατάει στα χέρια του 
το οποίο τοποθετεί επάνω στη στοίβα. Όταν ξεκινά η παρτίδα ο παίκτης που παίζει πρώτος έχει δύο επιλογές: 
α) να ρίξει κάποιο από τα φύλλα που έχει στο χέρι του στην κεντρική στοίβα 
β) να μαζέψει το φύλλο που βρίσκεται στην κορυφή της κεντρικής στοίβας με κάποιο φύλλο που κρατάει στο χέρι 
όμοιας αξίας. Ρίχνοντας το φύλλο του, μαζεύει και το επάνω φύλλο της στοίβας και τοποθετεί και τα δύο φύλλα σε 
δική του ξεχωριστή στοίβα, αφήνοντας όμως τα φύλλα φανερά.  Από τη στιγμή που κάποιος παίκτης ξεκίνησε δική 
του στοίβα, προστίθενται στις επιλογές των παικτών εκτός από τις α) και β) που προαναφέραμε, και άλλες δύο: 
γ) αν κρατάει στο χέρι του φύλλο όμοιο με τα φύλλα που βρίσκονται στην κορυφή της στοίβας ενός άλλου παίκτη, 
τότε μπορεί να το ρίξει και να πάρει τα φύλλα από την στοίβα του συγκεκριμένου παίκτη και να τα τοποθετήσει 
στην δική του στοίβα, δ) αν κρατάει στο χέρι του φύλλο που είναι ίδιο με αυτά που έχει επάνω στην δική του στοίβα,
μπορεί να ρίξει το φύλλο και να το προσθέσει σε αυτήν. Αν ο παίκτης μαζέψει ξανά νέα φύλλα είτε από την κεντρική 
στοίβα είτε από την στοίβα κάποιου άλλου παίκτη, τα τοποθετεί επάνω από τα ήδη υπάρχοντα της στοίβας του 
Τώρα στη συγκεκριμένη στοίβα, δεν μπορεί κάποιος αντίπαλος να μαζέψει τα φύλλα που βρίσκονται από κάτω 
επειδή καλύπτονται από αυτά που προστέθηκαν στη στοίβα τελευταία. Μόνο αν μαζευτούν από τη στοίβα του παίκτη 
τα φύλλα που βρίσκονται στην κορυφή της μπορούν εν συνεχεία να μαζευτούν τα από κάτω που πλέον περνάνε στην 
κορυφή της στοίβας. Όταν τελειώσουν όλοι οι παίκτες τα φύλλα τους, ξαναμοιράζονται από άλλα έξι ο καθένας. 
Τέλος παιχνιδιού ο παίκτης που θα συμπληρώσει πρώτος 61 πόντους ανακυρήσσεται νικητής. 

Η βάση μας κρατάει τους παρακάτω πίνακες: board, board_empty, players, game_status

Υλοποιήθηκαν οι παρακάτω απαιτήσεις:

- Αρχικοποίηση σύνδεσης-authentication.
- Έλεγχος κανόνων παιχνιδιού.
- Αναγνώριση σειράς παιξιάς.
- Αναγνώριση DeadLock (τέλος παιχνιδιού ή ο παίκτης εγκατέλειψε).
- Υπολογισμός σκορ / Ανάδειξη νικητή.
- Ανάπτυξη API.
- Ανάπτυξη GUI.
- Πλήρης αποθήκευση κατάστασης παιχνιδιού σε mysql.
- Ο πρώτος παίκτης περιμένει αντίπαλο όπου χρειάζεται.


Η εφαρμογή απαπτύχθηκε μέχρι το σημείο:
--------------------------------------------------

## Συντελεστές
Συμμετοχή:
- Αλεξίου Ελένη
- Γκιώση Πασχαλίνα

# Περιγραφή API

## Methods


### Board
#### Ανάγνωση Board

```
GET /board/
```

Επιστρέφει το [Board](#Board) (τα φύλλα του παίκτη και τα φύλλα που έχουν παιχτεί στο τραπέζι).

#### Αρχικοποίηση Board
```
POST /board/
```

Αρχικοποιεί το Board, δηλαδή το παιχνίδι. Γίνονται reset τα πάντα σε σχέση με το παιχνίδι.
Επιστρέφει το [Board](#Board).

### Card
#### Παίξιμο κάρτας

```
PUT /board/card/:x
```
Παίζει την κάρτα με αναγνωριστικό x από το χέρι του παίκτη στο τραπέζι, και αν είναι ίδιο, μαζεύει τις δυο ίδιες κάρτες. Προφανώς ελέγχεται αν η κάρτα υπάρχει στο χέρι του παίκτη, καθώς και αν είναι η σειρά του παίκτη να παίξει με βάση το token.
Επιστρέφει τα νέα στοιχεία από το [Board](#Board-1).

Json Data:

| Field             | Description                 | Required   |
| ----------------- | --------------------------- | ---------- |
| `x`               | Το αναγνωριστικό της κάρτας x                | yes        |


### Player

#### Ανάγνωση στοιχείων παίκτη
```
GET /players/:p
```

Επιστρέφει τα στοιχεία του παίκτη p ή όλων των παικτών αν παραληφθεί. Το p μπορεί να είναι 1 ή 2.

#### Καθορισμός στοιχείων παίκτη
```
PUT /players/:p
```

Επιστρέφει τα στοιχεία του παίκτη p και ένα token. Το token πρέπει να το χρησιμοποιεί ο παίκτης καθόλη τη διάρκεια του παιχνιδιού.

Json Data:

| Field             | Description                 | Required   |
| ----------------- | --------------------------- | ---------- |
| `username`        | Το username για τον παίκτη p. | yes        |


### Status

#### Ανάγνωση κατάστασης παιχνιδιού
```
GET /status/
```

Επιστρέφει το στοιχείο [Game_status](#Game_status).

## Entities


### Board
---------

Το board είναι ένας πίνακας, ο οποίος στο κάθε στοιχείο έχει τα παρακάτω:

| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `card_id`                      | Το αναγνωριστικό της κάρτας              | 1..52                                |
| `c_value`                      | Οι κάρτες(απο 1 εώς το 13) ανάλογα το "χρώμα"              | 1..13                                |
| `c_score`                | Η παικτική αξία της κάρτας                      | 1..13                             |
| `c_position`            | Η θέση της κάρτας στο board                         | 'deck', 'stack', 'top', 'hand1', 'hand2', 'stack1', 'stack2'                       |
| `c_order`                  | Η σειρά της κάρτας στην τράπουλα           | 1...52, null       |


### Players
---------

O κάθε παίκτης έχει τα παρακάτω στοιχεία:

| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `p_id`               | Το αναγνωριστικό του παίκτη                                 | 1, 2                              |
| `username`            | Ονομα παίκτη                                    | String                             |
| `token  `                | To κρυφό token του παίκτη. Επιστρέφεται μόνο τη στιγμή της εισόδου του παίκτη στο παιχνίδι | HEX |
| `last_action`            | Τελευταία ενέργεια του παίκτη                | Timestamp                             |


### Game_status
---------


H κατάσταση παιχνιδιού έχει τα παρακάτω στοιχεία:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `s_id`               | Το αναγνωριστικό για τον πίνακα game_status             | Integer    |
| `status`               | Κατάσταση             | 'not active', 'initialized', 'started', 'ended', 'aborted'     |
| `p_turn`                 | Το αναγνωριστικό του παίκτη που παίζει       | 1, 2, null                              |
| `result`                 |  To αναγνωριστικό του παίκτη που κέρδισε |1, 2, null                              |
| `last_change`            | Τελευταία αλλαγή/ενέργεια στην κατάσταση του παιχνιδιού         | Timestamp |

















